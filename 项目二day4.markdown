# mine/editTravels.html
## 更换封面
<img alt="项目二day4-254b60e1.png" src="assets/项目二day4-254b60e1.png" width="" height="" >

<img alt="项目二day4-2205f3c9.png" src="assets/项目二day4-2205f3c9.png" width="" height="" >

## 富文本插件
例子:  
<img alt="项目二day4-b16b3409.png" src="assets/项目二day4-b16b3409.png" width="" height="" >  
使用方法  
<img alt="项目二day4-5caa76de.png" src="assets/项目二day4-5caa76de.png" width="" height="" >

引入
<img alt="项目二day4-46f746f4.png" src="assets/项目二day4-46f746f4.png" width="" height="" >

文件上传
<img alt="项目二day4-887aa714.png" src="assets/项目二day4-887aa714.png" width="" height="" >

富文本编辑器
<img alt="项目二day4-3d53f427.png" src="assets/项目二day4-3d53f427.png" width="" height="" >

要使用编辑器的位置
图片上传的地址

<img alt="项目二day4-180c2d0f.png" src="assets/项目二day4-180c2d0f.png" width="" height="" >
删掉
文件上传权限先注释掉

Wdatepicker  
<img alt="项目二day4-0e870e92.png" src="assets/项目二day4-0e870e92.png" width="" height="" >

旅游地点变成动态
jquery autocomplete

获取旅游地区接口
1.资源路径  /regions
2.请求动作  get
3.请求参数  qo
4.返回结果  List<Region>

<img alt="项目二day4-57277ed2.png" src="assets/项目二day4-57277ed2.png" width="" height="" >

<img alt="项目二day4-581500b4.png" src="assets/项目二day4-581500b4.png" width="" height="" >

<img alt="项目二day4-01659f06.png" src="assets/项目二day4-01659f06.png" width="" height="" >

<img alt="项目二day4-3d335537.png" src="assets/项目二day4-3d335537.png" width="" height="" >

<img alt="项目二day4-3d23b64e.png" src="assets/项目二day4-3d23b64e.png" width="" height="" >

<img alt="项目二day4-139c4690.png" src="assets/项目二day4-139c4690.png" width="" height="" >

<img alt="项目二day4-fc5d5c84.png" src="assets/项目二day4-fc5d5c84.png" width="" height="" >

发布按钮
<img alt="项目二day4-9abffa03.png" src="assets/项目二day4-9abffa03.png" width="" height="" >

作用1:验证表单(可以控制表单是否提交)
作用2:提交表当前:添加表单参数

<img alt="项目二day4-2addb1c3.png" src="assets/项目二day4-2addb1c3.png" width="" height="" >

arr为表单中要提交的参数和值
将要提交的内容添加到arr中即可

arr.push({name:"",value:""})

<img alt="项目二day4-f0ccbce8.png" src="assets/项目二day4-f0ccbce8.png" width="" height="" >

<img alt="项目二day4-c174a9e1.png" src="assets/项目二day4-c174a9e1.png" width="" height="" >

<img alt="项目二day4-505f07d6.png" src="assets/项目二day4-505f07d6.png" width="" height="" >

<img alt="项目二day4-d521c274.png" src="assets/项目二day4-d521c274.png" width="" height="" >

<img alt="项目二day4-3093c604.png" src="assets/项目二day4-3093c604.png" width="" height="" >

<img alt="项目二day4-bde7e028.png" src="assets/项目二day4-bde7e028.png" width="" height="" >


<img alt="项目二day4-f5773432.png" src="assets/项目二day4-f5773432.png" width="" height="" >

<img alt="项目二day4-6d1334f5.png" src="assets/项目二day4-6d1334f5.png" width="" height="" >

<img alt="项目二day4-7a1c1feb.png" src="assets/项目二day4-7a1c1feb.png" width="" height="" >

beforeSubmit

接口:
新增游记文章的接口
1.资源路径  /travels
2.请求动作  post
3.请求参数  游记对象travel对象
4.返回结果  JsonResult

<img alt="项目二day4-0a880af0.png" src="assets/项目二day4-0a880af0.png" width="" height="" >

<img alt="项目二day4-6e5a2763.png" src="assets/项目二day4-6e5a2763.png" width="" height="" >

<img alt="项目二day4-021c13fe.png" src="assets/项目二day4-021c13fe.png" width="" height="" >

<img alt="项目二day4-e42e23c7.png" src="assets/项目二day4-e42e23c7.png" width="" height="" >

<img alt="项目二day4-ee0c0b10.png" src="assets/项目二day4-ee0c0b10.png" width="" height="" >

<img alt="项目二day4-04ee09fd.png" src="assets/项目二day4-04ee09fd.png" width="" height="" >
新增删除创建.更新时间
更新删除创建时间 作者

<img alt="项目二day4-1aff32ea.png" src="assets/项目二day4-1aff32ea.png" width="" height="" >

<img alt="项目二day4-e5e8e0d1.png" src="assets/项目二day4-e5e8e0d1.png" width="" height="" >

<img alt="项目二day4-9a96a6cf.png" src="assets/项目二day4-9a96a6cf.png" width="" height="" >

<img alt="项目二day4-87e5d393.png" src="assets/项目二day4-87e5d393.png" width="" height="" >

<img alt="项目二day4-719607b3.png" src="assets/项目二day4-719607b3.png" width="" height="" >

<img alt="项目二day4-868473ca.png" src="assets/项目二day4-868473ca.png" width="" height="" >

<img alt="项目二day4-24569276.png" src="assets/项目二day4-24569276.png" width="" height="" >

<img alt="项目二day4-9f93c3ea.png" src="assets/项目二day4-9f93c3ea.png" width="" height="" >

<img alt="项目二day4-ef7cca19.png" src="assets/项目二day4-ef7cca19.png" width="" height="" >

<img alt="项目二day4-b51e349c.png" src="assets/项目二day4-b51e349c.png" width="" height="" >

<img alt="项目二day4-a10a021b.png" src="assets/项目二day4-a10a021b.png" width="" height="" >

编辑 回显 修改 审核
# 获取游记内容
## 接口:
根据游记ID获取游记详细详细
1.资源路径  /travels/{id}
2.请求动作  get
3.请求参数  无
4.返回结果  游记travel对象
<img alt="项目二day4-e64ad333.png" src="assets/项目二day4-e64ad333.png" width="" height="" >

<img alt="项目二day4-074afcea.png" src="assets/项目二day4-074afcea.png" width="" height="" >

<img alt="项目二day4-c340ebb0.png" src="assets/项目二day4-c340ebb0.png" width="" height="" >

## 前端
页面之间的数据传递
跳转页面的时候传递id
<img alt="项目二day4-27b1b0f9.png" src="assets/项目二day4-27b1b0f9.png" width="" height="" >

<img alt="项目二day4-79e6ae9d.png" src="assets/项目二day4-79e6ae9d.png" width="" height="" >

<img alt="项目二day4-f219f825.png" src="assets/项目二day4-f219f825.png" width="" height="" >

<img alt="项目二day4-2c2e552b.png" src="assets/项目二day4-2c2e552b.png" width="" height="" >

<img alt="项目二day4-60926534.png" src="assets/项目二day4-60926534.png" width="" height="" >

<img alt="项目二day4-caeadd33.png" src="assets/项目二day4-caeadd33.png" width="" height="" >

<img alt="项目二day4-90171697.png" src="assets/项目二day4-90171697.png" width="" height="" >

<img alt="项目二day4-72daf78a.png" src="assets/项目二day4-72daf78a.png" width="" height="" >

<img alt="项目二day4-db8504ef.png" src="assets/项目二day4-db8504ef.png" width="" height="" >

<img alt="项目二day4-2f6f837c.png" src="assets/项目二day4-2f6f837c.png" width="" height="" >

<img alt="项目二day4-d3b57eed.png" src="assets/项目二day4-d3b57eed.png" width="" height="" >

<img alt="项目二day4-9d5a79be.png" src="assets/项目二day4-9d5a79be.png" width="" height="" >

<img alt="项目二day4-97733ee0.png" src="assets/项目二day4-97733ee0.png" width="" height="" >

<img alt="项目二day4-48faf162.png" src="assets/项目二day4-48faf162.png" width="" height="" >

<img alt="项目二day4-27cde9fd.png" src="assets/项目二day4-27cde9fd.png" width="" height="" >

<img alt="项目二day4-12224baf.png" src="assets/项目二day4-12224baf.png" width="" height="" >

# 保存操作
<img alt="项目二day4-5028bc11.png" src="assets/项目二day4-5028bc11.png" width="" height="" >

<img alt="项目二day4-14c7ca9d.png" src="assets/项目二day4-14c7ca9d.png" width="" height="" >

<img alt="项目二day4-decfcd69.png" src="assets/项目二day4-decfcd69.png" width="" height="" >

<img alt="项目二day4-2ee003a0.png" src="assets/项目二day4-2ee003a0.png" width="" height="" >

顺序问题,要在变成富文本编辑器之前先设置内容
不要用render-html

<img alt="项目二day4-158c55c2.png" src="assets/项目二day4-158c55c2.png" width="" height="" >

<img alt="项目二day4-e9c403e6.png" src="assets/项目二day4-e9c403e6.png" width="" height="" >

<img alt="项目二day4-e197d543.png" src="assets/项目二day4-e197d543.png" width="" height="" >

# 审核
admin待审核游记页面
默认查询待审核游记
也可以使用下拉框查询已拒绝的游记
按照时间(最后更新时间正序)来排序

admin已发布游记页面
只查询已发布状态的游记
按照发布时间倒叙排序

<img alt="项目二day4-aadee713.png" src="assets/项目二day4-aadee713.png" width="" height="" >

<img alt="项目二day4-97a957e1.png" src="assets/项目二day4-97a957e1.png" width="" height="" >

<img alt="项目二day4-e90489f8.png" src="assets/项目二day4-e90489f8.png" width="" height="" >

<img alt="项目二day4-e0d5221e.png" src="assets/项目二day4-e0d5221e.png" width="" height="" >

<img alt="项目二day4-4e1a7160.png" src="assets/项目二day4-4e1a7160.png" width="" height="" >

<img alt="项目二day4-48aed1b0.png" src="assets/项目二day4-48aed1b0.png" width="" height="" >

<img alt="项目二day4-330869d9.png" src="assets/项目二day4-330869d9.png" width="" height="" >

<img alt="项目二day4-5ebabe88.png" src="assets/项目二day4-5ebabe88.png" width="" height="" >

<img alt="项目二day4-16c62878.png" src="assets/项目二day4-16c62878.png" width="" height="" >

<img alt="项目二day4-8520c0a9.png" src="assets/项目二day4-8520c0a9.png" width="" height="" >

<img alt="项目二day4-86954ff3.png" src="assets/项目二day4-86954ff3.png" width="" height="" >

<img alt="项目二day4-c4fabf80.png" src="assets/项目二day4-c4fabf80.png" width="" height="" >

<img alt="项目二day4-6760e610.png" src="assets/项目二day4-6760e610.png" width="" height="" >

<img alt="项目二day4-fab549d3.png" src="assets/项目二day4-fab549d3.png" width="" height="" >

//先绑定json-id=entity.id
<img alt="项目二day4-20fa5d34.png" src="assets/项目二day4-20fa5d34.png" width="" height="" >

<img alt="项目二day4-8944eb50.png" src="assets/项目二day4-8944eb50.png" width="" height="" >

要加.do
<img alt="项目二day4-585eac04.png" src="assets/项目二day4-585eac04.png" width="" height="" >

<img alt="项目二day4-9510dc39.png" src="assets/项目二day4-9510dc39.png" width="" height="" >

<img alt="项目二day4-31992d3e.png" src="assets/项目二day4-31992d3e.png" width="" height="" >

<img alt="项目二day4-798a81dd.png" src="assets/项目二day4-798a81dd.png" width="" height="" >

<img alt="项目二day4-875142e5.png" src="assets/项目二day4-875142e5.png" width="" height="" >

<img alt="项目二day4-02ba9f5f.png" src="assets/项目二day4-02ba9f5f.png" width="" height="" >

<img alt="项目二day4-744319a9.png" src="assets/项目二day4-744319a9.png" width="" height="" >


实现类要settrue
<img alt="项目二day4-b3febe68.png" src="assets/项目二day4-b3febe68.png" width="" height="" >

<img alt="项目二day4-4b2ae072.png" src="assets/项目二day4-4b2ae072.png" width="" height="" >

<img alt="项目二day4-a71a5393.png" src="assets/项目二day4-a71a5393.png" width="" height="" >

<img alt="项目二day4-094a1fbf.png" src="assets/项目二day4-094a1fbf.png" width="" height="" >

<img alt="项目二day4-64a99092.png" src="assets/项目二day4-64a99092.png" width="" height="" >

<img alt="项目二day4-cde07b88.png" src="assets/项目二day4-cde07b88.png" width="" height="" >

<img alt="项目二day4-f1181f35.png" src="assets/项目二day4-f1181f35.png" width="" height="" >

<img alt="项目二day4-51f5c72a.png" src="assets/项目二day4-51f5c72a.png" width="" height="" >

<img alt="项目二day4-713167c6.png" src="assets/项目二day4-713167c6.png" width="" height="" >

<img alt="项目二day4-7f7cff42.png" src="assets/项目二day4-7f7cff42.png" width="" height="" >

<img alt="项目二day4-4c8c5eb3.png" src="assets/项目二day4-4c8c5eb3.png" width="" height="" >

<img alt="项目二day4-136e9b54.png" src="assets/项目二day4-136e9b54.png" width="" height="" >

<img alt="项目二day4-99ea6ceb.png" src="assets/项目二day4-99ea6ceb.png" width="" height="" >

<img alt="项目二day4-2c44a0c5.png" src="assets/项目二day4-2c44a0c5.png" width="" height="" >

<img alt="项目二day4-d08a112e.png" src="assets/项目二day4-d08a112e.png" width="" height="" >

<img alt="项目二day4-2711bbe0.png" src="assets/项目二day4-2711bbe0.png" width="" height="" >

# 小结
1. app游记新增和编辑页面
该页面显示的地区不能查询已经禁用的数据
利用beforeSubmit方法,添加额外需要提交的数据(封面/标题/内容 getContent 状态)
新增游记时,需要设置作者,先保存游记表在保持内容表(id),

<img alt="项目二day4-a65f7fb6.png" src="assets/项目二day4-a65f7fb6.png" width="" height="" >





# 总结
1. 游记封面上传
```
点击背景,触发文件上传input的点击事件,
选中图片后,触发值改变事件,提交文件上传表单
回调函数:attr("src",data.url)回显img
```
2. 富文本编辑器
```
引入jquery(注意顺序)
引入核心
引入文件上传组件
```
<img alt="项目二day4-83d30225.png" src="assets/项目二day4-83d30225.png" width="" height="" >

3. 获取当前旅游地区接口
```
获取旅游地区接口
1.资源路径  /regions
2.请求动作  get
3.请求参数  qo(state,undisbale)
4.返回结果  List<Region>
```
4. 提交游记表单参数
```
beforeSubmit:function(arr){}//提交之前执行的函数
作用1:数据校验
作用2:提交表单前添加表单参数
arr.push({name:"123",value:"321"})
```
5. 保存游记接口
```
新增游记文章的接口
1.资源路径  /travels
2.请求动作  post
3.请求参数  游记对象travel对象
4.返回结果  JsonResult
```
```
sql 中 now()设置当期时间
实现类中 通过用户上下文设置作者
处理内容表 新增travel得到id后,在插入travelContent
```
6. 根据id获取游记信息
```
新增游记文章的接口
1.资源路径  /travels/{id}
2.请求动作  get
3.请求参数  无
4.返回结果  游记对象travel
```
7. 回显游记内容
```
render-key:指定要获取的参数,先调用对应方法格式化,再设值
```

<img alt="项目二day4-3dd5c3a2.png" src="assets/项目二day4-3dd5c3a2.png" width="" height="" >  

<img alt="项目二day4-c47340d4.png" src="assets/项目二day4-c47340d4.png" width="" height="" >

8. 回显bug
```
render-attr="property=value"
get:异步请求,不能保证代码自上而下执行
```
9. 游记更新
```
设值表单提交方式
有id:post  新增
无id:put   更新
Edr.append("...") 添加富文本内容,
而不用render-html渲染
```
10. admin待审核页面
```
admin待审核页面
默认查询待审核状态的游记,并且是公开的
也可以使用下拉框查询已拒绝的游记
按照最后更新时间正序排列
```
```
查看:填充模态框,show,设置图片样式,让图片不超过模态框
拒绝:绑定id和状态到按钮,接口用对象接收更方便
发布:同上,另外要设置发布时间
```
11. admin已发布页面
```
admin已发布游记页面
只查询已发布状态的游记
按照发布时间倒序排序
取消发布:
查看文章:
```
